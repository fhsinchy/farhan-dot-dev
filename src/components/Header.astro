---
import { Menu, X } from 'lucide-astro';

const currentPath = Astro.url.pathname;

// Helper function to check if route is active
const isActive = (path: string) => {
  if (path === '/') return currentPath === '/';
  return currentPath.startsWith(path);
};
---

<!-- Skip to main content link for accessibility -->
<a 
  href="#main-content" 
  class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-[100] focus:px-4 focus:py-2 focus:bg-primary focus:text-primary-foreground focus:rounded-md focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"
>
  Skip to main content
</a>

<header class="fixed top-0 left-0 right-0 z-50 border-b border-border bg-background/95 backdrop-blur">
  <nav class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between" aria-label="Main navigation">
    <a
      href="/"
      class="text-foreground hover:text-primary transition-colors"
    >
      <span class="font-semibold">farhan.dev</span>
    </a>

    <!-- Desktop Navigation -->
    <div class="hidden md:flex items-center gap-8">
      <a
        href="/"
        class={`transition-colors ${
          isActive('/') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/') ? 'page' : undefined}
      >
        Home
      </a>
      <a
        href="/about"
        class={`transition-colors ${
          isActive('/about') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/about') ? 'page' : undefined}
      >
        About
      </a>
      <a
        href="/nuggets"
        class={`transition-colors ${
          isActive('/nuggets') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/nuggets') ? 'page' : undefined}
      >
        Nuggets
      </a>
      <a
        href="/newsletter"
        class={`transition-colors ${
          isActive('/newsletter') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/newsletter') ? 'page' : undefined}
      >
        Newsletter
      </a>
      <a
        href="/contact"
        class={`transition-colors ${
          isActive('/contact') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/contact') ? 'page' : undefined}
      >
        Contact
      </a>
    </div>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-button"
      class="md:hidden text-foreground"
      aria-label="Toggle mobile menu"
      aria-expanded="false"
      aria-controls="mobile-menu"
    >
      <Menu id="menu-icon" size={24} />
      <X id="close-icon" size={24} class="hidden" />
    </button>
  </nav>

  <!-- Mobile Navigation -->
  <div id="mobile-menu" class="hidden md:hidden border-t border-border bg-background">
    <div class="max-w-6xl mx-auto px-6 py-4 flex flex-col gap-4">
      <a
        href="/"
        class={`text-left transition-colors ${
          isActive('/') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/') ? 'page' : undefined}
      >
        Home
      </a>
      <a
        href="/about"
        class={`text-left transition-colors ${
          isActive('/about') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/about') ? 'page' : undefined}
      >
        About
      </a>
      <a
        href="/nuggets"
        class={`text-left transition-colors ${
          isActive('/nuggets') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/nuggets') ? 'page' : undefined}
      >
        Nuggets
      </a>
      <a
        href="/newsletter"
        class={`text-left transition-colors ${
          isActive('/newsletter') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/newsletter') ? 'page' : undefined}
      >
        Newsletter
      </a>
      <a
        href="/contact"
        class={`text-left transition-colors ${
          isActive('/contact') 
            ? 'text-primary' 
            : 'text-muted-foreground hover:text-foreground'
        }`}
        aria-current={isActive('/contact') ? 'page' : undefined}
      >
        Contact
      </a>
    </div>
  </div>
</header>

<script>
  // Mobile menu toggle
  const menuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');
  const closeIcon = document.getElementById('close-icon');

  menuButton?.addEventListener('click', () => {
    const isExpanded = menuButton.getAttribute('aria-expanded') === 'true';
    
    mobileMenu?.classList.toggle('hidden');
    menuIcon?.classList.toggle('hidden');
    closeIcon?.classList.toggle('hidden');
    menuButton.setAttribute('aria-expanded', String(!isExpanded));
  });
</script>
